<!DOCTYPE html>
<html lang="en">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  Â  <link rel="icon" type="image/png" href="favicon.png">
Â  Â  <title>VanityForge</title>
Â  Â  <script src="https://cdn.tailwindcss.com"></script>
Â  Â  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
Â  Â  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
Â  Â  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
Â  Â  <script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.min.js"></script>
Â  Â  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
Â  Â  <style>
Â  Â  Â  Â  body { background-color: #1a1a1a; color: #e0e0e0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; padding-top: 80px; }
Â  Â  Â  Â  .glass-panel { background: rgba(40, 40, 40, 0.7); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.1); }
Â  Â  Â  Â  /* Custom scrollbar for better aesthetics */
Â  Â  Â  Â  ::-webkit-scrollbar { width: 8px; }
Â  Â  Â  Â  ::-webkit-scrollbar-track { background: #1a1a1a; }
Â  Â  Â  Â  ::-webkit-scrollbar-thumb { background: #4a4a4a; border-radius: 4px; }
Â  Â  Â  Â  ::-webkit-scrollbar-thumb:hover { background: #6a6a6a; }
Â  Â  Â  Â  .numpad-btn {
Â  Â  Â  Â  Â  Â  @apply bg-gray-800 hover:bg-gray-700 text-white font-bold py-4 rounded-lg shadow transition transform active:scale-95 text-xl;
Â  Â  Â  Â  }
Â  Â  Â  Â  .pin-dot {
Â  Â  Â  Â  Â  Â  width: 12px; height: 12px; border-radius: 50%; background-color: #4b5563; transition: all 0.2s;
Â  Â  Â  Â  }
Â  Â  Â  Â  .pin-dot.active {
Â  Â  Â  Â  Â  Â  background-color: #9333ea; box-shadow: 0 0 8px #9333ea;
Â  Â  Â  Â  }
Â  Â  </style>
</head>
<body class="min-h-screen flex flex-col items-center px-4">

Â  Â  <nav class="fixed top-0 left-0 w-full z-50 glass-panel border-b border-gray-700/50">
Â  Â  Â  Â  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
Â  Â  Â  Â  Â  Â  <div class="flex items-center justify-between h-16">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex items-center">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex-shrink-0">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="text-purple-500 font-bold text-xl tracking-wider uppercase"><i class="fa-solid fa-fire-flame-curved"></i> VanityForge</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="hidden md:block">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="ml-10 flex items-baseline space-x-4">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <a href="/" class="text-white bg-gray-900 px-3 py-2 rounded-md text-sm font-medium transition-colors">Forge</a>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <a href="/roadmap" class="text-gray-300 hover:text-white hover:bg-gray-700 px-3 py-2 rounded-md text-sm font-medium transition-colors">Roadmap</a>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <a href="/faq" class="text-gray-300 hover:text-white hover:bg-gray-700 px-3 py-2 rounded-md text-sm font-medium transition-colors">FAQ</a>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <a href="https://x.com/vanityforgeX" target="_blank" class="text-gray-300 hover:text-white hover:bg-gray-700 px-3 py-2 rounded-md text-sm font-medium transition-colors"><i class="fa-brands fa-x-twitter"></i></a>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <a href="https://github.com/TomaAytakin/VanityForge" target="_blank" class="text-gray-300 hover:text-white hover:bg-gray-700 px-3 py-2 rounded-md text-sm font-medium transition-colors"><i class="fa-brands fa-github"></i> GitHub</a>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="-mr-2 flex md:hidden">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button type="button" onclick="document.getElementById('mobile-menu').classList.toggle('hidden')" class="bg-gray-800 inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-white hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-white">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="sr-only">Open main menu</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <i class="fa-solid fa-bars"></i>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="hidden md:hidden" id="mobile-menu">
Â  Â  Â  Â  Â  Â  <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
Â  Â  Â  Â  Â  Â  Â  Â  <a href="/" class="text-white bg-gray-900 block px-3 py-2 rounded-md text-base font-medium">Forge</a>
Â  Â  Â  Â  Â  Â  Â  Â  <a href="/roadmap" class="text-gray-300 hover:text-white block px-3 py-2 rounded-md text-base font-medium">Roadmap</a>
Â  Â  Â  Â  Â  Â  Â  Â  <a href="/faq" class="text-gray-300 hover:text-white block px-3 py-2 rounded-md text-base font-medium">FAQ</a>
Â  Â  Â  Â  Â  Â  Â  Â  <a href="https://x.com/vanityforgeX" target="_blank" class="text-gray-300 hover:text-white block px-3 py-2 rounded-md text-base font-medium"><i class="fa-brands fa-x-twitter"></i> X (Twitter)</a>
Â  Â  Â  Â  Â  Â  Â  Â  <a href="https://github.com/TomaAytakin/VanityForge" target="_blank" class="text-gray-300 hover:text-white block px-3 py-2 rounded-md text-base font-medium">GitHub</a>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  </nav>

Â  Â  <div class="w-full max-w-2xl mb-8 flex justify-center mt-10">
Â  Â  Â  Â  <img src="animated_forge.gif" alt="VanityForge Banner" class="rounded-xl shadow-2xl border border-gray-700 max-w-full h-auto">
Â  Â  </div>

Â  Â  <div id="auth-section" class="w-full max-w-2xl glass-panel p-8 rounded-xl shadow-lg text-center transition-all duration-300">
Â  Â  Â  Â  <h2 class="text-2xl font-bold mb-6 text-purple-400">Connect to VanityForge</h2>
Â  Â  Â  Â  <div class="flex flex-col gap-4 max-w-xs mx-auto">
Â  Â  Â  Â  Â  Â  <button onclick="loginWithGoogle()" class="bg-white hover:bg-gray-100 text-gray-800 font-bold py-3 px-6 rounded-lg transition duration-200 flex items-center justify-center gap-2 shadow-md hover:shadow-lg transform hover:-translate-y-0.5">
Â  Â  Â  Â  Â  Â  Â  Â  <i class="fa-brands fa-google"></i> Login with Google
Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  <button id="connect-phantom-btn" onclick="connectWallet()" class="bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 px-6 rounded-lg transition duration-200 flex items-center justify-center gap-2 shadow-md hover:shadow-lg transform hover:-translate-y-0.5">
Â  Â  Â  Â  Â  Â  Â  Â  <i class="fa-solid fa-wallet"></i> Connect Phantom
Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div id="app-interface" class="w-full max-w-2xl hidden space-y-6 animate-fade-in-up">

Â  Â  Â  Â  <div class="glass-panel p-8 rounded-xl shadow-lg relative overflow-hidden">
Â  Â  Â  Â  Â  Â  <div class="absolute top-0 right-0 p-4 opacity-10">
Â  Â  Â  Â  Â  Â  Â  Â  <i class="fa-solid fa-code text-6xl text-purple-500"></i>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <h2 class="text-xl font-bold mb-4 text-purple-400 flex items-center gap-2">
Â  Â  Â  Â  Â  Â  Â  Â  <i class="fa-solid fa-plus-circle"></i> Request New Vanity Address
Â  Â  Â  Â  Â  Â  </h2>

Â  Â  Â  Â  Â  Â  <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
Â  Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label class="block text-sm text-gray-400 mb-1">Prefix (Starts with)</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" id="prefix" class="w-full bg-gray-800 border border-gray-700 rounded p-2 focus:border-purple-500 focus:outline-none text-white font-mono placeholder-gray-600" placeholder="e.g. CAFE">
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label class="block text-sm text-gray-400 mb-1">Suffix (Ends with)</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" id="suffix" class="w-full bg-gray-800 border border-gray-700 rounded p-2 focus:border-purple-500 focus:outline-none text-white font-mono placeholder-gray-600" placeholder="e.g. 888">
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <p class="text-xs text-gray-500 mb-4">Note: Characters 0, O, I, and l are not allowed by Solana for security reasons.</p>

Â  Â  Â  Â  Â  Â  <div class="flex flex-col gap-3 mb-4">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex items-center gap-2">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="relative inline-block w-10 mr-2 align-middle select-none transition duration-200 ease-in">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="checkbox" name="toggle" id="case-sensitive" class="toggle-checkbox absolute block w-5 h-5 rounded-full bg-white border-4 appearance-none cursor-pointer"/>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label for="case-sensitive" class="toggle-label block overflow-hidden h-5 rounded-full bg-gray-700 cursor-pointer"></label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label for="case-sensitive" class="text-sm text-gray-300 cursor-pointer select-none">Case Sensitive</label>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="ml-auto flex items-center gap-2">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="checkbox" id="email-notify" class="w-4 h-4 text-purple-600 bg-gray-700 border-gray-600 rounded focus:ring-purple-500 focus:ring-2">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label for="email-notify" class="text-sm text-gray-300 cursor-pointer select-none">Email me when done</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  <div id="gpu-option-container" class="hidden flex items-center gap-2 p-2 bg-purple-900/20 rounded border border-purple-500/30">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <input type="checkbox" id="use-gpu" class="w-4 h-4 text-purple-600 bg-gray-700 border-gray-600 rounded focus:ring-purple-500 focus:ring-2">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <label for="use-gpu" class="text-sm text-gray-300 cursor-pointer select-none flex items-center gap-2">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <i class="fa-solid fa-bolt text-yellow-400"></i>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span>Use GPU Turbo Mode (+50% Cost)</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â </label>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  <style>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  .toggle-checkbox:checked { right: 0; border-color: #9333ea; }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  .toggle-checkbox:checked + .toggle-label { background-color: #9333ea; }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  .toggle-checkbox { right: 0; border-color: #4b5563; transition: all 0.3s; top: 0; left: 0;}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  .toggle-checkbox:checked { left: 50%; }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  .toggle-label { width: 100%; }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  .toggle-checkbox { position: absolute; top:0; left: 0; right: auto; bottom: auto; }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  .toggle-checkbox:checked { left: 1.25rem; border-color: #a855f7; }
Â  Â  Â  Â  Â  Â  Â  Â  </style>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="bg-gray-800/50 rounded-lg p-4 mb-6 text-sm border border-gray-700">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex justify-between items-center mb-2">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="text-gray-400">Difficulty:</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span id="calc-difficulty" class="text-white font-bold">0 chars</span>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex justify-between items-center mb-2">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="text-gray-400">Est. Time:</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span id="calc-time" class="text-white font-mono">Instant</span>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex justify-between items-center pt-2 border-t border-gray-700">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="text-gray-400">Cost:</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span id="calc-cost" class="text-green-400 font-bold font-mono">0 Credits</span>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <button onclick="startSubmissionFlow()" class="w-full bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700 text-white font-bold py-3 rounded-lg shadow-lg transition transform hover:scale-[1.01] active:scale-[0.99] flex justify-center items-center gap-2">
Â  Â  Â  Â  Â  Â  Â  Â  <i class="fa-solid fa-rocket"></i> Forge
Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  <p id="submit-error" class="text-red-400 text-sm mt-3 text-center hidden bg-red-900/20 py-2 rounded border border-red-900/50"></p>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div id="job-queue-section" class="glass-panel p-8 rounded-xl shadow-lg hidden"> Â  Â  Â  Â  Â  Â  <h3 class="text-lg font-bold mb-4 text-gray-300 border-b border-gray-700 pb-2 flex items-center justify-between">
Â  Â  Â  Â  Â  Â  Â  Â  <span><i class="fa-solid fa-list-ul mr-2 text-purple-500"></i>Your Jobs</span>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex items-center gap-3">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="text-xs font-normal text-gray-500" id="user-id-display"></span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="logout()" class="text-xs text-red-400 hover:text-red-300 transition-colors" title="Logout">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <i class="fa-solid fa-sign-out-alt"></i>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </h3>
Â  Â  Â  Â  Â  Â  <div class="overflow-x-auto">
Â  Â  Â  Â  Â  Â  Â  Â  <table class="w-full text-left border-collapse" style="table-layout: fixed;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <thead>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tr class="text-gray-400 border-b border-gray-700 text-xs uppercase tracking-wider">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <th class="py-3 font-medium text-gray-500" style="width: 25%;">Target</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <th class="py-3 font-medium text-gray-500" style="width: 20%;">Status</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <th class="py-3 font-medium text-gray-500" style="width: 55%;">Details / Key</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </thead>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tbody id="jobs-container" class="text-sm divide-y divide-gray-800">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </tbody>
Â  Â  Â  Â  Â  Â  Â  Â  </table>
Â  Â  Â  Â  Â  Â  Â  Â  <div id="jobs-empty-state" class="text-center text-gray-500 italic py-8 hidden">No active jobs found.</div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div id="numpad-modal" class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-80 backdrop-blur-sm hidden transition-opacity duration-300">
Â  Â  Â  Â  <div class="bg-gray-900 border border-gray-700 rounded-2xl shadow-2xl p-6 w-full max-w-sm transform scale-95 transition-transform duration-300" id="numpad-content">
Â  Â  Â  Â  Â  Â  <h3 id="numpad-title" class="text-center text-xl font-bold text-white mb-6">Enter Vault PIN</h3>

Â  Â  Â  Â  Â  Â  <div id="numpad-warning" class="hidden bg-yellow-900/30 border border-yellow-600/50 text-yellow-200 p-3 rounded mb-4 text-xs text-left">
Â  Â  Â  Â  Â  Â  Â  Â  <p class="font-bold mb-1"><i class="fa-solid fa-triangle-exclamation mr-1"></i> Warning:</p>
Â  Â  Â  Â  Â  Â  Â  Â  You are about to create a permanent encryption PIN. VanityForge does not store this PIN. If you lose it, you will permanently lose the capability to reveal your private keys or forge new wallets within your VanityForge account. We cannot recover it for you.
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="flex justify-center gap-4 mb-8" id="pin-display">
Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div id="numpad-checkbox-container" class="hidden mb-4 text-left">
Â  Â  Â  Â  Â  Â  Â  Â  Â <label class="flex items-start gap-2 text-xs text-gray-400 cursor-pointer">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="checkbox" id="pin-acknowledge" class="mt-0.5 w-4 h-4 text-purple-600 bg-gray-700 border-gray-600 rounded focus:ring-purple-500 focus:ring-2">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span>I acknowledge that VanityForge cannot recover my PIN if lost, and that losing my PIN means I will be unable to reveal my private keys or access my VanityForge account functions.</span>
Â  Â  Â  Â  Â  Â  Â  Â  </label>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="grid grid-cols-3 gap-4">
Â  Â  Â  Â  Â  Â  Â  Â  <button class="numpad-btn bg-gray-800 hover:bg-gray-700 text-white font-bold py-4 rounded-lg shadow transition transform active:scale-95 text-xl" onclick="numpadInput(1)">1</button>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="numpad-btn bg-gray-800 hover:bg-gray-700 text-white font-bold py-4 rounded-lg shadow transition transform active:scale-95 text-xl" onclick="numpadInput(2)">2</button>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="numpad-btn bg-gray-800 hover:bg-gray-700 text-white font-bold py-4 rounded-lg shadow transition transform active:scale-95 text-xl" onclick="numpadInput(3)">3</button>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="numpad-btn bg-gray-800 hover:bg-gray-700 text-white font-bold py-4 rounded-lg shadow transition transform active:scale-95 text-xl" onclick="numpadInput(4)">4</button>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="numpad-btn bg-gray-800 hover:bg-gray-700 text-white font-bold py-4 rounded-lg shadow transition transform active:scale-95 text-xl" onclick="numpadInput(5)">5</button>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="numpad-btn bg-gray-800 hover:bg-gray-700 text-white font-bold py-4 rounded-lg shadow transition transform active:scale-95 text-xl" onclick="numpadInput(6)">6</button>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="numpad-btn bg-gray-800 hover:bg-gray-700 text-white font-bold py-4 rounded-lg shadow transition transform active:scale-95 text-xl" onclick="numpadInput(7)">7</button>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="numpad-btn bg-gray-800 hover:bg-gray-700 text-white font-bold py-4 rounded-lg shadow transition transform active:scale-95 text-xl" onclick="numpadInput(8)">8</button>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="numpad-btn bg-gray-800 hover:bg-gray-700 text-white font-bold py-4 rounded-lg shadow transition transform active:scale-95 text-xl" onclick="numpadInput(9)">9</button>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="numpad-btn bg-gray-800 hover:bg-gray-700 text-red-400 font-bold py-4 rounded-lg shadow transition transform active:scale-95 text-xl" onclick="numpadClear()"><i class="fa-solid fa-delete-left"></i></button>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="numpad-btn bg-gray-800 hover:bg-gray-700 text-white font-bold py-4 rounded-lg shadow transition transform active:scale-95 text-xl" onclick="numpadInput(0)">0</button>
Â  Â  Â  Â  Â  Â  Â  Â  <button id="numpad-submit-btn" class="numpad-btn bg-purple-600 hover:bg-purple-700 text-white font-bold py-4 rounded-lg shadow transition transform active:scale-95 text-xl" onclick="numpadSubmit()"><i class="fa-solid fa-check"></i></button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <button onclick="closeNumpad()" class="mt-6 w-full text-gray-500 hover:text-white text-sm">Cancel</button>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div id="beta-modal" class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-80 backdrop-blur-sm hidden transition-opacity duration-300">
Â  Â  Â  Â  <div class="bg-gray-900 border border-purple-500 rounded-2xl shadow-2xl p-6 w-full max-w-sm transform scale-95 transition-transform duration-300 text-center relative overflow-hidden" id="beta-modal-content">
Â  Â  Â  Â  Â  Â  <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-purple-500 to-pink-500"></div>
Â  Â  Â  Â  Â  Â  <i class="fa-solid fa-tags text-4xl text-purple-400 mb-4 animate-bounce"></i>
Â  Â  Â  Â  Â  Â  <h3 class="text-2xl font-bold text-white mb-2">Beta Access Unlocked!</h3>
Â  Â  Â  Â  Â  Â  <p class="text-gray-300 mb-6">You've received a <span class="text-purple-400 font-bold">50% Discount</span> on all vanity address generations during our Beta phase.</p>
Â  Â  Â  Â  Â  Â  <button onclick="closeBetaModal()" class="bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white font-bold py-2 px-6 rounded-lg shadow-lg transition transform hover:scale-105">
Â  Â  Â  Â  Â  Â  Â  Â  Let's Forge!
Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <script>
Â  Â  Â  Â  // CONFIGURATION (HARDCODED)
Â  Â  Â  Â  const TREASURY_WALLET_ADDRESS = "CUfjsGUee8u83dfFxHt1jXJUCRLiF1KoWVYcKyVforGe";
Â  Â  Â  Â  const API_URL = "/submit-job"; // Relative path
Â  Â  Â  Â  const FIREBASE_CONFIG = {
Â  Â  Â  Â  Â  Â  apiKey: "AIzaSyCSYhscdfpQD19GMsm3qIJw9AWC5OYjqMY",
Â  Â  Â  Â  Â  Â  authDomain: "vanityforge.firebaseapp.com",
Â  Â  Â  Â  Â  Â  projectId: "vanityforge",
Â  Â  Â  Â  Â  Â  storageBucket: "vanityforge.firebasestorage.app",
Â  Â  Â  Â  Â  Â  messagingSenderId: "124272129554",
Â  Â  Â  Â  Â  Â  appId: "1:124272129554:web:5e4f9e1d89bd54b3accacb",
Â  Â  Â  Â  Â  Â  measurementId: "G-97FJY9VP2K"
Â  Â  Â  Â  };
Â  Â  Â  Â  // INIT FIREBASE
Â  Â  Â  Â  if (!firebase.apps.length) {
Â  Â  Â  Â  Â  Â  firebase.initializeApp(FIREBASE_CONFIG);
Â  Â  Â  Â  }
Â  Â  Â  Â  const db = firebase.firestore();
Â  Â  Â  Â  // CHECK REDIRECT RESULT
Â  Â  Â  Â  firebase.auth().getRedirectResult().then((result) => {
Â  Â  Â  Â  Â  Â  if (result.user) {
Â  Â  Â  Â  Â  Â  Â  Â  const user = result.user;
Â  Â  Â  Â  Â  Â  Â  Â  currentUser = user.uid;
Â  Â  Â  Â  Â  Â  Â  Â  currentUserEmail = user.email;
Â  Â  Â  Â  Â  Â  Â  Â  checkUserStatus(currentUser);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }).catch((error) => {
Â  Â  Â  Â  Â  Â  console.error("Redirect Login Error:", error);
Â  Â  Â  Â  Â  Â  // Optional: alert(error.message);
Â  Â  Â  Â  });
Â  Â  Â  Â  // STATE
Â  Â  Â  Â  const ADMIN_EMAILS = ["tomaaytakin@gmail.com", "Jonny95hidalgo@gmail.com", "admin@vanityforge.org"];
Â  Â  Â  Â  var currentUser = null;
Â  Â  Â  Â  var currentUserEmail = null;
Â  Â  Â  Â  var jobListenerUnsubscribe = null;
Â  Â  Â  Â  var userTrialsUsed = 0;

Â  Â  Â  Â  // AUDIO SYSTEM
Â  Â  Â  Â  const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
Â  Â  Â  Â  function playSound(type) {
Â  Â  Â  Â  Â  Â  if (audioCtx.state === 'suspended') audioCtx.resume();
Â  Â  Â  Â  Â  Â  const oscillator = audioCtx.createOscillator();
Â  Â  Â  Â  Â  Â  const gainNode = audioCtx.createGain();

Â  Â  Â  Â  Â  Â  oscillator.connect(gainNode);
Â  Â  Â  Â  Â  Â  gainNode.connect(audioCtx.destination);
Â  Â  Â  Â  Â  Â  if (type === 'input') {
Â  Â  Â  Â  Â  Â  Â  Â  // High pitch blip
Â  Â  Â  Â  Â  Â  Â  Â  oscillator.type = 'sine';
Â  Â  Â  Â  Â  Â  Â  Â  // or triangle
Â  Â  Â  Â  Â  Â  Â  Â  oscillator.frequency.setValueAtTime(880, audioCtx.currentTime);
Â  Â  Â  Â  Â  Â  Â  Â  // A5
Â  Â  Â  Â  Â  Â  Â  Â  oscillator.frequency.exponentialRampToValueAtTime(100, audioCtx.currentTime + 0.1);
Â  Â  Â  Â  Â  Â  Â  Â  gainNode.gain.setValueAtTime(0.1, audioCtx.currentTime);
Â  Â  Â  Â  Â  Â  Â  Â  gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.1);

Â  Â  Â  Â  Â  Â  Â  Â  oscillator.start();
Â  Â  Â  Â  Â  Â  Â  Â  oscillator.stop(audioCtx.currentTime + 0.1);
Â  Â  Â  Â  Â  Â  } else if (type === 'delete') {
Â  Â  Â  Â  Â  Â  Â  Â  // Low pitch whoosh/buzz
Â  Â  Â  Â  Â  Â  Â  Â  oscillator.type = 'sawtooth';
Â  Â  Â  Â  Â  Â  Â  Â  oscillator.frequency.setValueAtTime(150, audioCtx.currentTime);
Â  Â  Â  Â  Â  Â  Â  Â  oscillator.frequency.linearRampToValueAtTime(50, audioCtx.currentTime + 0.2);

Â  Â  Â  Â  Â  Â  Â  Â  gainNode.gain.setValueAtTime(0.1, audioCtx.currentTime);
Â  Â  Â  Â  Â  Â  Â  Â  gainNode.gain.linearRampToValueAtTime(0.01, audioCtx.currentTime + 0.2);

Â  Â  Â  Â  Â  Â  Â  Â  oscillator.start();
Â  Â  Â  Â  Â  Â  Â  Â  oscillator.stop(audioCtx.currentTime + 0.2);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  // NUMPAD LOGIC
Â  Â  Â  Â  let currentPin = "";
Â  Â  Â  Â  let numpadMode = ""; // 'create', 'submit', 'reveal'
Â  Â  Â  Â  let numpadCallback = null;
Â  Â  Â  Â  let revealJobId = null;

Â  Â  Â  Â  function openNumpad(mode, title, callback, jobId = null) {
Â  Â  Â  Â  Â  Â  currentPin = "";
Â  Â  Â  Â  Â  Â  numpadMode = mode;
Â  Â  Â  Â  Â  Â  numpadCallback = callback;
Â  Â  Â  Â  Â  Â  revealJobId = jobId;

Â  Â  Â  Â  Â  Â  document.getElementById('numpad-title').innerText = title;
Â  Â  Â  Â  Â  Â  updatePinDisplay();

Â  Â  Â  Â  Â  Â  const warningEl = document.getElementById('numpad-warning');
Â  Â  Â  Â  Â  Â  const checkboxContainer = document.getElementById('numpad-checkbox-container');
Â  Â  Â  Â  Â  Â  const checkbox = document.getElementById('pin-acknowledge');
Â  Â  Â  Â  Â  Â  const submitBtn = document.getElementById('numpad-submit-btn');

Â  Â  Â  Â  Â  Â  if (mode === 'create') {
Â  Â  Â  Â  Â  Â  Â  Â  warningEl.classList.remove('hidden');
Â  Â  Â  Â  Â  Â  Â  Â  checkboxContainer.classList.remove('hidden');
Â  Â  Â  Â  Â  Â  Â  Â  checkbox.checked = false;
Â  Â  Â  Â  Â  Â  Â  Â  updateSubmitButtonState();
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  warningEl.classList.add('hidden');
Â  Â  Â  Â  Â  Â  Â  Â  checkboxContainer.classList.add('hidden');
Â  Â  Â  Â  Â  Â  Â  Â  submitBtn.disabled = false;
Â  Â  Â  Â  Â  Â  Â  Â  submitBtn.classList.remove('opacity-50', 'cursor-not-allowed');
Â  Â  Â  Â  Â  Â  Â  Â  submitBtn.classList.add('hover:bg-purple-700', 'active:scale-95');
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  const modal = document.getElementById('numpad-modal');
Â  Â  Â  Â  Â  Â  modal.classList.remove('hidden');
Â  Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('numpad-content').classList.replace('scale-95', 'scale-100');
Â  Â  Â  Â  Â  Â  }, 10);
Â  Â  Â  Â  }

Â  Â  Â  Â  document.getElementById('pin-acknowledge').addEventListener('change', updateSubmitButtonState);

Â  Â  Â  Â  function updateSubmitButtonState() {
Â  Â  Â  Â  Â  Â  if (numpadMode !== 'create') return;

Â  Â  Â  Â  Â  Â  const checkbox = document.getElementById('pin-acknowledge');
Â  Â  Â  Â  Â  Â  const submitBtn = document.getElementById('numpad-submit-btn');

Â  Â  Â  Â  Â  Â  if (checkbox.checked) {
Â  Â  Â  Â  Â  Â  Â  Â  submitBtn.disabled = false;
Â  Â  Â  Â  Â  Â  Â  Â  submitBtn.classList.remove('opacity-50', 'cursor-not-allowed');
Â  Â  Â  Â  Â  Â  Â  Â  submitBtn.classList.add('hover:bg-purple-700', 'active:scale-95');
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  submitBtn.disabled = true;
Â  Â  Â  Â  Â  Â  Â  Â  submitBtn.classList.add('opacity-50', 'cursor-not-allowed');
Â  Â  Â  Â  Â  Â  Â  Â  submitBtn.classList.remove('hover:bg-purple-700', 'active:scale-95');
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  function closeNumpad() {
Â  Â  Â  Â  Â  Â  const modal = document.getElementById('numpad-modal');
Â  Â  Â  Â  Â  Â  document.getElementById('numpad-content').classList.replace('scale-100', 'scale-95');
Â  Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  Â  modal.classList.add('hidden');
Â  Â  Â  Â  Â  Â  }, 300);
Â  Â  Â  Â  Â  Â  currentPin = "";
Â  Â  Â  Â  }

Â  Â  Â  Â  function numpadInput(num) {
Â  Â  Â  Â  Â  Â  if (currentPin.length < 6) {
Â  Â  Â  Â  Â  Â  Â  Â  currentPin += num;
Â  Â  Â  Â  Â  Â  Â  Â  playSound('input');
Â  Â  Â  Â  Â  Â  Â  Â  updatePinDisplay();
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  function numpadClear() {
Â  Â  Â  Â  Â  Â  if (currentPin.length > 0) {
Â  Â  Â  Â  Â  Â  Â  Â  currentPin = currentPin.slice(0, -1);
Â  Â  Â  Â  Â  Â  Â  Â  playSound('delete');
Â  Â  Â  Â  Â  Â  Â  Â  updatePinDisplay();
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  function updatePinDisplay() {
Â  Â  Â  Â  Â  Â  const container = document.getElementById('pin-display');
Â  Â  Â  Â  Â  Â  container.innerHTML = '';
Â  Â  Â  Â  Â  Â  // Always show 6 slots
Â  Â  Â  Â  Â  Â  for (let i = 0; i < 6; i++) {
Â  Â  Â  Â  Â  Â  Â  Â  const dot = document.createElement('div');
Â  Â  Â  Â  Â  Â  Â  Â  dot.className = `pin-dot ${i < currentPin.length ? 'active' : ''}`;
Â  Â  Â  Â  Â  Â  Â  Â  container.appendChild(dot);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  async function numpadSubmit() {
Â  Â  Â  Â  Â  Â  if (currentPin.length < 4) {
Â  Â  Â  Â  Â  Â  Â  Â  alert("PIN must be at least 4 digits.");
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  playSound('input'); // Confirm sound?
Â  Â  Â  Â  Â  Â  if (numpadMode === 'create') {
Â  Â  Â  Â  Â  Â  Â  Â  await setPin(currentPin);
Â  Â  Â  Â  Â  Â  } else if (numpadMode === 'submit') {
Â  Â  Â  Â  Â  Â  Â  Â  numpadCallback(currentPin);
Â  Â  Â  Â  Â  Â  } else if (numpadMode === 'reveal') {
Â  Â  Â  Â  Â  Â  Â  Â  numpadCallback(revealJobId, currentPin);
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  closeNumpad();
Â  Â  Â  Â  }

Â  Â  Â  Â  // AUTHENTICATION
Â  Â  Â  Â  async function loginWithGoogle() {
Â  Â  Â  Â  Â  Â  const provider = new firebase.auth.GoogleAuthProvider();
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  const result = await firebase.auth().signInWithPopup(provider);
Â  Â  Â  Â  Â  Â  Â  Â  const user = result.user;
Â  Â  Â  Â  Â  Â  Â  Â  currentUser = user.uid;
Â  Â  Â  Â  Â  Â  Â  Â  currentUserEmail = user.email;
Â  Â  Â  Â  Â  Â  Â  Â  await checkUserStatus(currentUser);
Â  Â  Â  Â  Â  Â  } catch (error) {
Â  Â  Â  Â  Â  Â  Â  Â  console.error("Popup error:", error);
Â  Â  Â  Â  Â  Â  Â  Â  alert("Google Login Failed: " + error.message);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  async function connectWallet() {
Â  Â  Â  Â  Â  Â  if (window.solana && window.solana.isPhantom) {
Â  Â  Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const resp = await window.solana.connect();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  currentUser = resp.publicKey.toString();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  await checkUserStatus(currentUser);
Â  Â  Â  Â  Â  Â  Â  Â  } catch (err) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.error(err);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  alert("Connection failed.");
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  window.open("https://phantom.app/", "_blank");
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  async function checkUserStatus(userId) {
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  const res = await fetch('/check-user', {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  method: 'POST',
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  headers: {'Content-Type': 'application/json'},
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  body: JSON.stringify({ user_id: userId })
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  const data = await res.json();
Â  Â  Â  Â  Â  Â  Â  Â  userTrialsUsed = data.trials_used || 0;
Â  Â  Â  Â  Â  Â  Â  Â  if (data.has_pin) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  onLoginSuccess();
Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Prompt to create PIN
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('auth-section').classList.add('hidden');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Hide auth temporarily
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  openNumpad('create', 'Create your Vault PIN', null);
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  } catch (e) {
Â  Â  Â  Â  Â  Â  Â  Â  console.error(e);
Â  Â  Â  Â  Â  Â  Â  Â  alert("Error checking user status.");
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  async function setPin(pin) {
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  const res = await fetch('/set-pin', {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  method: 'POST',
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  headers: {'Content-Type': 'application/json'},
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  body: JSON.stringify({ user_id: currentUser, pin: pin })
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  if (res.ok) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  onLoginSuccess();
Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  alert("Failed to set PIN.");
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  location.reload();
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  } catch (e) {
Â  Â  Â  Â  Â  Â  Â  Â  console.error(e);
Â  Â  Â  Â  Â  Â  Â  Â  alert("Error setting PIN.");
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  function closeBetaModal() {
Â  Â  Â  Â  Â  Â  const modal = document.getElementById('beta-modal');
Â  Â  Â  Â  Â  Â  document.getElementById('beta-modal-content').classList.replace('scale-100', 'scale-95');
Â  Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  Â  modal.classList.add('hidden');
Â  Â  Â  Â  Â  Â  }, 300);
Â  Â  Â  Â  }

Â  Â  Â  Â  function onLoginSuccess(isDev = false) {
Â  Â  Â  Â  Â  Â  document.getElementById('auth-section').classList.add('hidden');
Â  Â  Â  Â  Â  Â  const appInterface = document.getElementById('app-interface');
Â  Â  Â  Â  Â  Â  appInterface.classList.remove('hidden');
Â  Â  Â  Â  Â  Â  // FIX 1: Show Job Queue Section
Â  Â  Â  Â  Â  Â  document.getElementById('job-queue-section').classList.remove('hidden');

Â  Â  Â  Â  Â  Â  // God Mode Check
Â  Â  Â  Â  Â  Â  if (ADMIN_EMAILS.includes(currentUserEmail)) {
Â  Â  Â  Â  Â  Â  Â  Â  const titleSpan = document.querySelector('nav .text-purple-500');
Â  Â  Â  Â  Â  Â  Â  Â  if (titleSpan) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  titleSpan.innerHTML = '<i class="fa-solid fa-fire-flame-curved"></i> Welcome Dev ðŸ› ï¸';
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  const godModeBadge = document.createElement('span');
Â  Â  Â  Â  Â  Â  Â  Â  godModeBadge.className = "ml-4 bg-yellow-500/20 text-yellow-400 text-xs font-bold px-2 py-1 rounded border border-yellow-500/50 animate-pulse";
Â  Â  Â  Â  Â  Â  Â  Â  godModeBadge.innerText = "God Mode Active";
Â  Â  Â  Â  Â  Â  Â  Â  titleSpan.appendChild(godModeBadge);
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  // Show Beta Modal
Â  Â  Â  Â  Â  Â  const betaModal = document.getElementById('beta-modal');
Â  Â  Â  Â  Â  Â  betaModal.classList.remove('hidden');
Â  Â  Â  Â  Â  Â  Â setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('beta-modal-content').classList.replace('scale-95', 'scale-100');
Â  Â  Â  Â  Â  Â  }, 10);
Â  Â  Â  Â  Â  Â  // Simple fade in effect
Â  Â  Â  Â  Â  Â  appInterface.style.opacity = 0;
Â  Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  Â  appInterface.style.transition = 'opacity 0.5s ease-in-out';
Â  Â  Â  Â  Â  Â  Â  Â  appInterface.style.opacity = 1;
Â  Â  Â  Â  Â  Â  }, 50);
Â  Â  Â  Â  Â  Â  let displayId = currentUser;
Â  Â  Â  Â  Â  Â  if (currentUser === "DEV_USER") displayId = "Dev Mode";
Â  Â  Â  Â  Â  Â  else if (currentUser.length > 10) displayId = currentUser.slice(0, 4) + '...' + currentUser.slice(-4);

Â  Â  Â  Â  Â  Â  document.getElementById('user-id-display').innerText = displayId;
Â  Â  Â  Â  Â  Â  // Default Check email notify if logged in via Google (and thus have email)
Â  Â  Â  Â  Â  Â  if (currentUserEmail) {
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('email-notify').checked = true;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  pollJobStatus();
Â  Â  Â  Â  }

Â  Â  Â  Â  // CALCULATIONS (Helpers)
Â  Â  Â  Â  function updateEstimates() {
Â  Â  Â  Â  Â  Â  const p = document.getElementById('prefix').value || "";
Â  Â  Â  Â  Â  Â  const s = document.getElementById('suffix').value || "";
Â  Â  Â  Â  Â  Â  const totalLen = p.length + s.length;

Â  Â  Â  Â  Â  Â  const gpuContainer = document.getElementById('gpu-option-container');
Â  Â  Â  Â  Â  Â  const useGpuCheckbox = document.getElementById('use-gpu');

Â  Â  Â  Â  Â  Â  // GPU Logic
Â  Â  Â  Â  Â  Â  if (totalLen >= 6) {
Â  Â  Â  Â  Â  Â  Â  Â  // Force GPU
Â  Â  Â  Â  Â  Â  Â  Â  gpuContainer.classList.remove('hidden');
Â  Â  Â  Â  Â  Â  Â  Â  useGpuCheckbox.checked = true;
Â  Â  Â  Â  Â  Â  Â  Â  useGpuCheckbox.disabled = true;
Â  Â  Â  Â  Â  Â  Â  Â  useGpuCheckbox.nextElementSibling.innerHTML = '<i class="fa-solid fa-bolt text-yellow-400"></i><span>High-Speed GPU Forge Required</span>';
Â  Â  Â  Â  Â  Â  } else if (totalLen >= 4) {
Â  Â  Â  Â  Â  Â  Â  Â  // Optional GPU
Â  Â  Â  Â  Â  Â  Â  Â  gpuContainer.classList.remove('hidden');
Â  Â  Â  Â  Â  Â  Â  Â  useGpuCheckbox.disabled = false;
Â  Â  Â  Â  Â  Â  Â  Â  useGpuCheckbox.nextElementSibling.innerHTML = '<i class="fa-solid fa-bolt text-yellow-400"></i><span>Use GPU Turbo Mode (+50% Cost)</span>';
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  // Hide
Â  Â  Â  Â  Â  Â  Â  Â  gpuContainer.classList.add('hidden');
Â  Â  Â  Â  Â  Â  Â  Â  useGpuCheckbox.checked = false;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  if (totalLen === 0) {
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('calc-difficulty').innerText = "0 chars";
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('calc-time').innerText = "Instant";
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('calc-cost').innerText = "0 SOL";
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  // Fixed Pricing Logic
Â  Â  Â  Â  Â  Â  let basePrice = 0;
Â  Â  Â  Â  Â  Â  if (totalLen <= 4) basePrice = 0.25;
Â  Â  Â  Â  Â  Â  else if (totalLen === 5) basePrice = 0.50;
Â  Â  Â  Â  Â  Â  else if (totalLen === 6) basePrice = 1.00;
Â  Â  Â  Â  Â  Â  else if (totalLen === 7) basePrice = 2.00;
Â  Â  Â  Â  Â  Â  else if (totalLen === 8) basePrice = 3.00;
Â  Â  Â  Â  Â  Â  else basePrice = 5.00;

Â  Â  Â  Â  Â  Â  // Apply GPU Surcharge if selected (or forced)
Â  Â  Â  Â  Â  Â  if (useGpuCheckbox.checked) {
Â  Â  Â  Â  Â  Â  Â  Â  basePrice = basePrice * 1.5;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  // Apply 50% Discount (on the final price)
Â  Â  Â  Â  Â  Â  let finalPrice = basePrice * 0.5;

Â  Â  Â  Â  Â  Â  // Check Trial (Only if NOT using GPU, or maybe trial allows GPU? Assuming trial is basic only usually, but let's assume trial covers cost)
Â  Â  Â  Â  Â  Â  // If user selects GPU, maybe trial doesn't apply? User requirement: "50% Beta Discount Applied".
Â  Â  Â  Â  Â  Â  // Let's assume Trial is valid for price 0, regardless of GPU selection if Length <= 4.
Â  Â  Â  Â  Â  Â  // But if they select GPU for length 4, does it cost money? "If selected, increase the calculated price by 50%."
Â  Â  Â  Â  Â  Â  // If trial makes it free, 0 * 1.5 = 0.

Â  Â  Â  Â  Â  Â  let isTrial = false;
Â  Â  Â  Â  Â  Â  if (totalLen <= 4 && userTrialsUsed < 2) {
Â  Â  Â  Â  Â  Â  Â  Â  isTrial = true;
Â  Â  Â  Â  Â  Â  Â  Â  finalPrice = 0;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  // Time Estimate
Â  Â  Â  Â  Â  Â  // Time (seconds) = (0.5 * 58^TotalLength) / Speed
Â  Â  Â  Â  Â  Â  // Speed: CPU ~5M/s, GPU ~500M/s? (Assume 100x or just significantly faster)
Â  Â  Â  Â  Â  Â  let speed = 5000000;
Â  Â  Â  Â  Â  Â  if (useGpuCheckbox.checked) {
Â  Â  Â  Â  Â  Â  Â  Â  speed = 500000000; // 500M/s
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  let seconds = (0.5 * Math.pow(58, totalLen)) / speed;
Â  Â  Â  Â  Â  Â  let timeStr;
Â  Â  Â  Â  Â  Â  if (seconds < 1) timeStr = "Instant";
Â  Â  Â  Â  Â  Â  else if (seconds < 60) timeStr = Math.ceil(seconds) + "s";
Â  Â  Â  Â  Â  Â  else if (seconds < 3600) timeStr = Math.ceil(seconds/60) + "m";
Â  Â  Â  Â  Â  Â  else if (seconds < 86400) timeStr = (seconds/3600).toFixed(1) + "h";
Â  Â  Â  Â  Â  Â  else timeStr = (seconds/86400).toFixed(1) + "d";

Â  Â  Â  Â  Â  Â  document.getElementById('calc-difficulty').innerText = totalLen + " chars";
Â  Â  Â  Â  Â  Â  document.getElementById('calc-time').innerText = timeStr;

Â  Â  Â  Â  Â  Â  const costEl = document.getElementById('calc-cost');
Â  Â  Â  Â  Â  Â  if (isTrial) {
Â  Â  Â  Â  Â  Â  Â  Â  Â // Trial UI: <del>0.25 SOL</del> FREE (Trial)
Â  Â  Â  Â  Â  Â  Â  Â  Â costEl.innerHTML = `<span style="text-decoration:line-through;" class="text-gray-500 mr-2">${basePrice.toFixed(2)} SOL</span> <span class="text-green-400">FREE (Trial)</span>`;
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â // Discount UI: <del>1.0 SOL</del> 0.5 SOL
Â  Â  Â  Â  Â  Â  Â  Â  Â costEl.innerHTML = `<span style="text-decoration:line-through;" class="text-gray-500 mr-2">${basePrice.toFixed(2)} SOL</span> <span class="text-purple-400">${finalPrice.toFixed(2)} SOL</span>`;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  // Hard Limit Warning - REMOVED for >5 because we now support it via GPU
Â  Â  Â  Â  Â  Â  /*
Â  Â  Â  Â  Â  Â  if (totalLen > 5 && !ADMIN_EMAILS.includes(currentUserEmail)) {
Â  Â  Â  Â  Â  Â  Â  Â  // ...
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  */
Â  Â  Â  Â  Â  Â // Clear errors
Â  Â  Â  Â  Â  Â document.getElementById('submit-error').classList.add('hidden');
Â  Â  Â  Â  Â  Â document.querySelector('button[onclick="startSubmissionFlow()"]').disabled = false;
Â  Â  Â  Â  Â  Â document.querySelector('button[onclick="startSubmissionFlow()"]').classList.remove('opacity-50', 'cursor-not-allowed');
Â  Â  Â  Â  }

Â  Â  Â  Â  ['prefix', 'suffix'].forEach(id => {
Â  Â  Â  Â  Â  Â  document.getElementById(id).addEventListener('input', (e) => {
Â  Â  Â  Â  Â  Â  Â  Â  const val = e.target.value;
Â  Â  Â  Â  Â  Â  Â  Â  const clean = val.replace(/[^1-9A-HJ-NP-Za-km-z]/g, '');
Â  Â  Â  Â  Â  Â  Â  Â  if (val !== clean) e.target.value = clean;
Â  Â  Â  Â  Â  Â  Â  Â  updateEstimates();
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  });

Â  Â  Â  Â  document.getElementById('use-gpu').addEventListener('change', updateEstimates);
Â  Â  Â  Â  // EMAIL NOTIFICATION LOGIC
Â  Â  Â  Â  document.getElementById('email-notify').addEventListener('change', async function(e) {
Â  Â  Â  Â  Â  Â  if (this.checked && !currentUserEmail) {
Â  Â  Â  Â  Â  Â  Â  Â  const provider = new firebase.auth.GoogleAuthProvider();
Â  Â  Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const result = await firebase.auth().signInWithPopup(provider);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const user = result.user;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  currentUser = user.uid;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  currentUserEmail = user.email;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  await checkUserStatus(currentUser);
Â  Â  Â  Â  Â  Â  Â  Â  } catch (error) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.error("Email login failed:", error);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  this.checked = false;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  alert("Email is required for notifications.");
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  });

Â  Â  Â  Â  // JOB SUBMISSION
Â  Â  Â  Â  function startSubmissionFlow() {
Â  Â  Â  Â  Â  Â  Â const prefix = document.getElementById('prefix').value;
Â  Â  Â  Â  Â  Â  Â const suffix = document.getElementById('suffix').value;
Â  Â  Â  Â  Â  Â  Â const totalLen = prefix.length + suffix.length;
Â  Â  Â  Â  Â  Â  Â if (!prefix && !suffix) {
Â  Â  Â  Â  Â  Â  Â  Â  const errorEl = document.getElementById('submit-error');
Â  Â  Â  Â  Â  Â  Â  Â  errorEl.innerText = "Please specify a prefix or suffix.";
Â  Â  Â  Â  Â  Â  Â  Â  errorEl.classList.remove('hidden');
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â  Â  Â  Â document.getElementById('submit-error').classList.add('hidden');
Â  Â  Â  Â  Â  Â  Â // Check estimated time
Â  Â  Â  Â  Â  Â  Â // Time (seconds) = (0.5 * 58^TotalLength) / 5,000,000
Â  Â  Â  Â  Â  Â  Â let seconds = (0.5 * Math.pow(58, totalLen)) / 5000000;
Â  Â  Â  Â  Â  Â  Â if (seconds > 3600) {
Â  Â  Â  Â  Â  Â  Â  Â  Â let timeStr;
Â  Â  Â  Â  Â  Â  Â  Â  Â if (seconds < 86400) timeStr = (seconds/3600).toFixed(1) + " hours";
Â  Â  Â  Â  Â  Â  Â  Â  Â else timeStr = (seconds/86400).toFixed(1) + " days";
Â  Â  Â  Â  Â  Â  Â  Â  Â if (!confirm(`This job may take ${timeStr}. Do you accept the wait and proceed?`)) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â return;
Â  Â  Â  Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â  Â  Â  Â }

Â  Â  Â  Â  Â  Â  Â openNumpad('submit', 'Enter PIN to Forge', submitJob);
Â  Â  Â  Â  }

Â  Â  Â  Â  async function submitJob(pin) {
Â  Â  Â  Â  Â  Â  const prefix = document.getElementById('prefix').value;
Â  Â  Â  Â  Â  Â  const suffix = document.getElementById('suffix').value;
Â  Â  Â  Â  Â  Â  const caseSensitive = document.getElementById('case-sensitive').checked;
Â  Â  Â  Â  Â  Â  const notify = document.getElementById('email-notify').checked;
Â  Â  Â  Â  Â  Â  const useGpu = document.getElementById('use-gpu').checked;

Â  Â  Â  Â  Â  Â  const errorEl = document.getElementById('submit-error');
Â  Â  Â  Â  Â  Â  const submitBtn = document.querySelector('button[onclick="startSubmissionFlow()"]');
Â  Â  Â  Â  Â  Â  // Disable button
Â  Â  Â  Â  Â  Â  submitBtn.disabled = true;

Â  Â  Â  Â  Â  Â  // God Mode Check
Â  Â  Â  Â  Â  Â  const isGodMode = ADMIN_EMAILS.includes(currentUserEmail);
Â  Â  Â  Â  Â  Â  // Calculate Price & Check Payment
Â  Â  Â  Â  Â  Â  const totalLen = prefix.length + suffix.length;
Â  Â  Â  Â  Â  Â  // Fixed Pricing Logic
Â  Â  Â  Â  Â  Â  let basePrice = 0;
Â  Â  Â  Â  Â  Â  if (totalLen <= 4) basePrice = 0.25;
Â  Â  Â  Â  Â  Â  else if (totalLen === 5) basePrice = 0.50;
Â  Â  Â  Â  Â  Â  else if (totalLen === 6) basePrice = 1.00;
Â  Â  Â  Â  Â  Â  else if (totalLen === 7) basePrice = 2.00;
Â  Â  Â  Â  Â  Â  else if (totalLen === 8) basePrice = 3.00;
Â  Â  Â  Â  Â  Â  else basePrice = 5.00;

Â  Â  Â  Â  Â  Â  // GPU Surcharge
Â  Â  Â  Â  Â  Â  if (useGpu) {
Â  Â  Â  Â  Â  Â  Â  Â  basePrice = basePrice * 1.5;
Â  Â  Â  Â  Â  Â  Â  Â  submitBtn.innerHTML = '<i class="fa-solid fa-spinner fa-spin"></i> Initializing RedPanda Engine...';
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  submitBtn.innerHTML = '<i class="fa-solid fa-spinner fa-spin"></i> Submitting...';
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  // Apply 50% Discount
Â  Â  Â  Â  Â  Â  let cost = basePrice * 0.5;
Â  Â  Â  Â  Â  Â  let isTrial = (totalLen <= 4 && userTrialsUsed < 2);
Â  Â  Â  Â  Â  Â  let transactionSignature = null;
Â  Â  Â  Â  Â  Â  // If trial, cost is 0
Â  Â  Â  Â  Â  Â  if (isTrial) cost = 0;
Â  Â  Â  Â  Â  Â  // God Mode Skips Payment
Â  Â  Â  Â  Â  Â  if (!isGodMode && cost > 0) {
Â  Â  Â  Â  Â  Â  Â  Â  Â if (!window.solana || !window.solana.isConnected) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â if (window.solana) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â try {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â await window.solana.connect();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â } catch (err) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â submitBtn.disabled = false;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â submitBtn.innerHTML = '<i class="fa-solid fa-rocket"></i> Forge';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â alert("Wallet required for payment");
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â return;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â submitBtn.disabled = false;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â submitBtn.innerHTML = '<i class="fa-solid fa-rocket"></i> Forge';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â alert("Phantom Wallet is required for payment.");
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â return;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â  Â  Â  Â  Â  Â }

Â  Â  Â  Â  Â  Â  Â  Â  Â try {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â // 2. Build Transaction
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â const TREASURY_PUBKEY = new solanaWeb3.PublicKey(TREASURY_WALLET_ADDRESS);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â const fromPubkey = window.solana.publicKey;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â const transaction = new solanaWeb3.Transaction().add(
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â solanaWeb3.SystemProgram.transfer({
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â fromPubkey: fromPubkey,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â toPubkey: TREASURY_PUBKEY,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â lamports: Math.round(cost * solanaWeb3.LAMPORTS_PER_SOL)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â })
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â );
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â transaction.feePayer = fromPubkey;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â // Use the dedicated Helius endpoint
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â // The user will replace the placeholder with their actual URL
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â // UPDATED WITH USER KEY
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â const connection = new solanaWeb3.Connection("https://mainnet.helius-rpc.com/?api-key=03ad30eb-2c13-45e9-83bd-19187d14e21a", "confirmed");
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â const { blockhash, lastValidBlockHeight } = await connection.getLatestBlockhash();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â transaction.recentBlockhash = blockhash;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â // 3. Sign and Send
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â const { signature } = await window.solana.signAndSendTransaction(transaction);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â transactionSignature = signature;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â // 4. Wait for Confirmation
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â submitBtn.innerHTML = '<i class="fa-solid fa-spinner fa-spin"></i> Confirming Payment...';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â await connection.confirmTransaction({
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â signature: signature,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â blockhash: blockhash,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â lastValidBlockHeight: lastValidBlockHeight
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â });

Â  Â  Â  Â  Â  Â  Â  Â  Â } catch (err) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â console.error(err);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â submitBtn.disabled = false;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â submitBtn.innerHTML = '<i class="fa-solid fa-rocket"></i> Forge';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â errorEl.innerText = "Payment failed: " + err.message;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â errorEl.classList.remove('hidden');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â return;
Â  Â  Â  Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  const payload = {
Â  Â  Â  Â  Â  Â  Â  Â  user_id: currentUser,
Â  Â  Â  Â  Â  Â  Â  Â  prefix: prefix,
Â  Â  Â  Â  Â  Â  Â  Â  suffix: suffix,
Â  Â  Â  Â  Â  Â  Â  Â  case_sensitive: caseSensitive,
Â  Â  Â  Â  Â  Â  Â  Â  pin: pin,
Â  Â  Â  Â  Â  Â  Â  Â  transaction_signature: transactionSignature,
Â  Â  Â  Â  Â  Â  Â  Â  email: currentUserEmail,
Â  Â  Â  Â  Â  Â  Â  Â  notify: notify,
Â  Â  Â  Â  Â  Â  Â  Â  use_gpu: useGpu
Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  const res = await fetch('/submit-job', {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  method: 'POST',
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  headers: { 'Content-Type': 'application/json' },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  body: JSON.stringify(payload)
Â  Â  Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  Â  Â  if (res.ok) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Update trials locally for immediate feedback
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (isTrial) userTrialsUsed++;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Success feedback
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('prefix').value = '';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('suffix').value = '';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  updateEstimates();
Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const data = await res.json().catch(() => ({}));
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  throw new Error(data.message || data.error || "Submission failed.");
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  } catch (e) {
Â  Â  Â  Â  Â  Â  Â  Â  errorEl.innerText = e.message;
Â  Â  Â  Â  Â  Â  Â  Â  errorEl.classList.remove('hidden');
Â  Â  Â  Â  Â  Â  } finally {
Â  Â  Â  Â  Â  Â  Â  Â  submitBtn.disabled = false;
Â  Â  Â  Â  Â  Â  Â  Â  submitBtn.innerHTML = '<i class="fa-solid fa-rocket"></i> Forge';
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  // POLLING & UI
Â  Â  Â  Â  function pollJobStatus() {
Â  Â  Â  Â  Â  Â  if (jobListenerUnsubscribe) jobListenerUnsubscribe();
Â  Â  Â  Â  Â  Â  const container = document.getElementById('jobs-container');
Â  Â  Â  Â  Â  Â  const emptyState = document.getElementById('jobs-empty-state');

Â  Â  Â  Â  Â  Â  jobListenerUnsubscribe = db.collection('vanity_jobs')
Â  Â  Â  Â  Â  Â  Â  Â  .where('user_id', '==', currentUser)
Â  Â  Â  Â  Â  Â  Â  Â  .orderBy('created_at', 'desc')
Â  Â  Â  Â  Â  Â  Â  Â  .onSnapshot((snapshot) => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (snapshot.empty) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  container.innerHTML = '';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  emptyState.classList.remove('hidden');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  emptyState.classList.add('hidden');

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const fragment = document.createDocumentFragment();

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  snapshot.forEach(doc => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const job = doc.data();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const status = (job.status || "").toUpperCase();

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Check if key is available
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const secretKey = job.secret_key; // Encrypted

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let statusColor = 'text-gray-400';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let statusIcon = '';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let resultHtml = '';

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (status === 'COMPLETED') {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  statusColor = 'text-green-400';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  statusIcon = '<i class="fa-solid fa-check-circle"></i>';

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Show Eye Icon and Copy Button
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  resultHtml = `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="mt-2 bg-gray-900/50 p-2 rounded border border-gray-700/50">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex justify-between items-center mb-1">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="text-[10px] text-gray-500 uppercase font-bold tracking-wider">Public Key</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="copyToClipboard('${job.public_key}')" class="text-xs text-purple-400 hover:text-purple-300 transition-colors" title="Copy Public Key"><i class="fa-regular fa-copy"></i></button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="font-mono text-[10px] break-all text-gray-300 mb-2 bg-black/20 p-1 rounded">${job.public_key}</div>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex justify-between items-center mb-1">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="text-[10px] text-gray-500 uppercase font-bold tracking-wider">Private Key</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="openNumpad('reveal', 'Enter PIN to Unlock', revealKey, '${doc.id}')" id="btn-${doc.id}" class="text-xs text-purple-400 hover:text-purple-300 transition-colors uppercase font-bold" title="Reveal Private Key"><i class="fa-regular fa-eye"></i></button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div id="secret-${doc.id}" class="hidden flex items-start gap-2 animate-fade-in">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div id="key-text-${doc.id}" class="font-mono text-[10px] break-all text-red-300 bg-red-900/10 p-1 rounded border border-red-900/20 flex-grow">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="copyKey('${doc.id}')" class="text-gray-400 hover:text-white pt-1 transition-colors" title="Copy Private Key"><i class="fa-regular fa-copy"></i></button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else if (status === 'FAILED') {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  statusColor = 'text-red-400';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  statusIcon = '<i class="fa-solid fa-times-circle"></i>';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  resultHtml = `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="mt-1 text-[10px] text-red-400 italic">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ${job.error || "Job failed."}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  statusColor = 'text-yellow-400';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  statusIcon = '<i class="fa-regular fa-clock animate-spin"></i>';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const tr = document.createElement('tr');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  tr.className = "hover:bg-gray-800/50 transition-colors align-top";
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  tr.innerHTML = `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td class="py-3 pr-2 border-b border-gray-800">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex flex-col gap-1">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="text-xs font-bold bg-gray-700 text-gray-300 px-2 py-1 rounded border border-gray-600 font-mono w-max">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ${job.prefix || '...'}-${job.suffix || '...'}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ${job.case_sensitive ? '<span class="text-[10px] text-purple-400 w-max border border-purple-500/30 bg-purple-500/10 px-1 py-0.5 rounded" title="Case Sensitive">Case Sensitive</span>' : ''}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="text-[10px] text-gray-600 font-mono uppercase tracking-widest">ID: ${doc.id.slice(0, 8)}...</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td class="py-3 pr-2 border-b border-gray-800">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="text-xs font-bold ${statusColor} capitalize flex items-center gap-1">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ${statusIcon} ${job.status}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td class="py-3 border-b border-gray-800">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ${resultHtml}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  fragment.appendChild(tr);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  container.innerHTML = '';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  container.appendChild(fragment);

Â  Â  Â  Â  Â  Â  Â  Â  }, (error) => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.error("Error polling jobs:", error);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  emptyState.innerText = 'Error connecting to job server.';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  emptyState.classList.remove('hidden');
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  }

Â  Â  Â  Â  function logout() {
Â  Â  Â  Â  Â  Â  if (jobListenerUnsubscribe) jobListenerUnsubscribe();
Â  Â  Â  Â  Â  Â  firebase.auth().signOut().then(() => {
Â  Â  Â  Â  Â  Â  Â  Â  currentUser = null;
Â  Â  Â  Â  Â  Â  Â  Â  currentUserEmail = null;
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('app-interface').classList.add('hidden');
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('auth-section').classList.remove('hidden');
Â  Â  Â  Â  Â  Â  Â  Â  // Hide job queue section after logout
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('job-queue-section').classList.add('hidden');
Â  Â  Â  Â  Â  Â  Â  Â  // Hide mobile menu if open
Â  Â  Â  Â  Â  Â  Â  Â  const mobileMenu = document.getElementById('mobile-menu');
Â  Â  Â  Â  Â  Â  Â  Â  if (mobileMenu && !mobileMenu.classList.contains('hidden')) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  mobileMenu.classList.add('hidden');
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  const titleSpan = document.querySelector('nav .text-purple-500');
Â  Â  Â  Â  Â  Â  Â  Â  if (titleSpan) titleSpan.innerHTML = '<i class="fa-solid fa-fire-flame-curved"></i> VanityForge';
Â  Â  Â  Â  Â  Â  }).catch((error) => {
Â  Â  Â  Â  Â  Â  Â  Â  console.error("Sign Out Error", error);
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  }

Â  Â  Â  Â  async function revealKey(jobId, pin) {
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  const res = await fetch('/reveal-key', {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  method: 'POST',
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  headers: {'Content-Type': 'application/json'},
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  body: JSON.stringify({ job_id: jobId, pin: pin })
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  const data = await res.json();

Â  Â  Â  Â  Â  Â  Â  Â  if (res.ok) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const el = document.getElementById(`secret-${jobId}`);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const btn = document.getElementById(`btn-${jobId}`);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const keyText = document.getElementById(`key-text-${jobId}`);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  keyText.innerText = data.secret_key;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  el.classList.remove('hidden');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  btn.innerHTML = '<i class="fa-regular fa-eye-slash"></i>';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  btn.onclick = () => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â el.classList.add('hidden');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â btn.innerHTML = '<i class="fa-regular fa-eye"></i>';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â keyText.innerText = '';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â // Reset onclick
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â btn.onclick = () => openNumpad('reveal', 'Enter PIN to Unlock', revealKey, jobId);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  alert(data.error || "Failed to reveal key.");
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  } catch (e) {
Â  Â  Â  Â  Â  Â  Â  Â  console.error(e);
Â  Â  Â  Â  Â  Â  Â  Â  alert("Error revealing key.");
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  function copyKey(id) {
Â  Â  Â  Â  Â  Â  const text = document.getElementById(`key-text-${id}`).innerText;
Â  Â  Â  Â  Â  Â  copyToClipboard(text);
Â  Â  Â  Â  }

Â  Â  Â  Â  function copyToClipboard(text) {
Â  Â  Â  Â  Â  Â  if (!text) return;
Â  Â  Â  Â  Â  Â  // Visual Feedback Function
Â  Â  Â  Â  Â  Â  const showFeedback = () => {
Â  Â  Â  Â  Â  Â  Â  Â  const activeEl = document.activeElement;
Â  Â  Â  Â  Â  Â  Â  Â  if(activeEl && (activeEl.tagName === 'BUTTON' || activeEl.closest('button'))) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const btn = activeEl.tagName === 'BUTTON' ? activeEl : activeEl.closest('button');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const icon = btn.querySelector('i');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if(icon) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const originalClass = icon.className;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  icon.className = "fa-solid fa-check text-green-400";

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Tooltip logic
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let tooltip = document.createElement("span");
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  tooltip.className = "absolute -top-8 left-1/2 transform -translate-x-1/2 bg-gray-900 text-white text-xs px-2 py-1 rounded shadow-lg animate-fade-in-up z-50 border border-gray-700";
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  tooltip.innerText = "Copied!";
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  btn.style.position = "relative";
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  btn.appendChild(tooltip);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  icon.className = "fa-regular fa-copy";
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if(tooltip) tooltip.remove();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }, 2000);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  Â  if (navigator.clipboard && window.isSecureContext) {
Â  Â  Â  Â  Â  Â  Â  Â  // Secure context (HTTPS)
Â  Â  Â  Â  Â  Â  Â  Â  navigator.clipboard.writeText(text).then(showFeedback).catch(err => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.error('Failed to copy via Clipboard API: ', err);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  fallbackCopy(text, showFeedback);
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  // Non-secure context (HTTP)
Â  Â  Â  Â  Â  Â  Â  Â  fallbackCopy(text, showFeedback);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  function fallbackCopy(text, successCallback) {
Â  Â  Â  Â  Â  Â  const textArea = document.createElement("textarea");
Â  Â  Â  Â  Â  Â  textArea.value = text;
Â  Â  Â  Â  Â  Â  textArea.style.position = "fixed";
Â  Â  Â  Â  Â  Â  textArea.style.left = "-9999px";
Â  Â  Â  Â  Â  Â  textArea.style.top = "0";
Â  Â  Â  Â  Â  Â  document.body.appendChild(textArea);
Â  Â  Â  Â  Â  Â  textArea.focus();
Â  Â  Â  Â  Â  Â  textArea.select();
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  const successful = document.execCommand('copy');
Â  Â  Â  Â  Â  Â  Â  Â  if (successful) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  successCallback();
Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  prompt("Copy to clipboard: Ctrl+C, Enter", text);
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  } catch (err) {
Â  Â  Â  Â  Â  Â  Â  Â  console.error('Fallback copy failed', err);
Â  Â  Â  Â  Â  Â  Â  Â  prompt("Copy to clipboard: Ctrl+C, Enter", text);
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  document.body.removeChild(textArea);
Â  Â  Â  Â  }

Â  Â  Â  Â  // Global assignments
Â  Â  Â  Â  window.loginWithGoogle = loginWithGoogle;
Â  Â  Â  Â  window.connectWallet = connectWallet;
Â  Â  Â  Â  window.startSubmissionFlow = startSubmissionFlow;
Â  Â  Â  Â  window.submitJob = submitJob;
Â  Â  Â  Â  window.revealKey = revealKey;
Â  Â  Â  Â  window.copyToClipboard = copyToClipboard;
Â  Â  Â  Â  window.copyKey = copyKey;
Â  Â  Â  Â  window.numpadInput = numpadInput;
Â  Â  Â  Â  window.numpadClear = numpadClear;
Â  Â  Â  Â  window.numpadSubmit = numpadSubmit;
Â  Â  Â  Â  window.closeNumpad = closeNumpad;
Â  Â  </script>
</body>
</html>
